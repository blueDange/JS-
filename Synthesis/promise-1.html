<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>promise</title>
</head>

<body>
    <!-- promise: 承诺 -->
    <!-- 承诺 做一个异步操作,成功或失败后,会回来通知 -->

    <script>
        // 固定格式
        // new Promise(): 新建一个`承诺`, 去完成一个耗时的操作,例如网络请求
        // - 成功后会触发then中的函数
        // - 失败后会触发catch中的函数
        // var p = new Promise((resolve, reject) => {
        //     // 假设请求需要3秒
        //     setInterval(() => {
        //         var num = (Math.random() * 100).toFixed(0)
        //         if (num < 50) {
        //             // 拒绝  -- 会触发 catch中的函数
        //             reject({ num, msg: "失败了" })
        //         } else {
        //             // 成功 -- 会触发 then 中的函数
        //             resolve({ num, msg: '成功了' })
        //         }
        //     }, 3000)
        // })

        // // 利用 then 和 catch 从承诺中监听结果
        // p.then((res) => console.log('then成功:', res)).catch((err) => console.log('catch失败:', err))


        // var f = new Promise((resolve, reject) => {
        //     setInterval(() => {
        //         var num = (Math.random() * 100).toFixed(0)
        //         if (num < 50) {
        //             reject({ num, msg: '失败了' })
        //         } else {
        //             resolve({ num, msg: '成功了' })
        //         }
        //     }, 2000)
        // })

        // f.then(res => console.log('then成功', res)).catch((err) => console.log('catch失败了', err))

        var m = new Promise((resolve, reject) => {
            setInterval(() => {
                var num = (Math.random() * 100).toFixed(0)
                if (num < 50) {
                    reject({ num, msg: '失败了' })
                } else {
                    resolve({ num, msg: '成功了' })
                }
            }, 2000)
        })

        m.then(res => console.log('then成功了', res)).catch(err => console.log('catch失败了', err))
    </script>
</body>

</html>